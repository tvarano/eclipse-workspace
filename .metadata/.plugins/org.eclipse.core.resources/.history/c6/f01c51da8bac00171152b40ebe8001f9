//Thomas Varano
//Aug 31, 2017

/**
 * A simple time class, holdig a few integers. Runs in 24 hour time.
 * @author varanoth
 * 
 */
public class Time implements Comparable<Time>
{
   public static final Time MIDNIGHT = new Time(0,0), 
         NOON = new Time(12,0); 
   public static final int HOUR_IN_DAY = 24, MIN_IN_DAY = 1440, SEC_IN_DAY = (MIN_IN_DAY*60), MIN_IN_HOUR = 60;
   private int hour24, minute;
   private boolean am;
   
   /**
    * 
    * Creates the Time with a 24 hour setting.
    * 
    * @param hour24 
    *    a military time hour to construct 
    * @param minute
    *    the minute time that the object will hold
    */
   public Time(int hour24, int minute) {
      hour24 %= HOUR_IN_DAY;
      hour24 += (minute / MIN_IN_HOUR);
      minute %= MIN_IN_HOUR;
      this.setHour24(hour24); this.setMinute(minute);
      am = hour24 < 12;
   }
   
   /**
    * Creates the Time with a 12 hour setting. The hours are converted based to a 24 hour scale.
    * 
    * @param hour12 
    *    an hour on a 12 hour scale
    * @param minute 
    *    the minute time that the object will hold
    * @param am
    *    tells if the time is in morning or night
    */
   public Time (int hour12, int minute, boolean am) {
      int hour = (am) ? hour12: hour12+HOUR_IN_DAY/2;
      this.am = am; this.setHour24(hour); this.setMinute(minute);
   }
   
   public Time (int totalMins) {
      this(totalMins / MIN_IN_HOUR, totalMins % MIN_IN_HOUR);
   }
   
   public Time() {
      this(-1,-1);
   }
   
   /**
    * calculates the duration of time from start to end.
    * 
    * @param startTime
    * @param endTime
    * @return the difference of the two times in a time object
    */
   public static Time calculateDuration(Time startTime, Time endTime) {
      return startTime.getTimeUntil(endTime);
   }
   
   public Time getTimeUntil(Time t) {
      if (t.compareTo(this) > 0)
         return t.minus(this);
      int minsToNextDay = new Time(11, 59).minus(this).getTotalMins()+1;
      int midnightToTime = t.getTotalMins();
      return new Time(minsToNextDay + midnightToTime);
   }
   
   public String toString() {
      String amString = (am) ? "AM" : "PM";
      return timeString() + " " + amString;
   }
   
   public String timeString() {
      String hourString = (hour24 > 12) ? (hour24 - 12)+"" : hour24 + "";
      String minuteString = (minute < 10) ? "0"+minute : minute+"";
      return hourString + ":" + minuteString;
   }
   public boolean equals(Time otherTime) {
      return (getTotalMins() == otherTime.getTotalMins());
   }
   public Time timeFromTotalMins(int mins) {
      mins %= MIN_IN_DAY;
      return new Time(mins / MIN_IN_HOUR, mins % MIN_IN_HOUR);
   }
   /**
    * subtracts the specified time from the implicit time. Assumes the implicit parameter is the later time. So, 
    * if the given time is later, it will be subracted as if it was from the day before. 
    * 
    * @param t the time to subtract
    * @return
    *    the difference between the times.
    */
   public Time minus(Time t)  {
      return minus(t.getTotalMins());
   }
   
   public Time minus(int min) {
      int minDif = getTotalMins() - min;
      if (minDif < 0)
         minDif += (MIN_IN_DAY);
      return new Time(minDif);
   }
   
   /**
    * adds the given minutes to the time the method is being performed on. 
    * 
    * @param min amount of minutes to add
    * @return the time plus amount of minutes
    */
   public Time plus(int min) {
      return timeFromTotalMins(min + getTotalMins());
   }
   
   public Time plus(Time t) {
      return plus(t.getTotalMins());
   }
   
   public int getHour12() {
      return (am && hour24 != 12) ? hour24 : hour24-12;
   }
   public int getTotalMins() {
      return (hour24 * MIN_IN_HOUR + minute);
   }
   public int getHour24() {
      return hour24;
   }
   public void setHour24(int hour24) {
      this.hour24 = hour24;
      this.am = (hour24 < 12);
   }
   public void setHour12(int hour12, boolean am) {
      if (am)
         this.setHour24(hour12);
      else 
         this.setHour24(hour12+12);
   }
   public int getMinute() {
      return minute;
   }
   public void setMinute(int minute) {
      this.minute = minute;
   }
   public boolean isAM() {
      return am;
   }

   @Override
   public int compareTo(Time o) {
      return getTotalMins() - o.getTotalMins();
   }
}
